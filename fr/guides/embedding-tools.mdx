---
title: "Guide : Intégrer UBIK avec un iframe"
description: "Apprenez à intégrer en toute sécurité l'interface utilisateur d'un outil UBIK directement dans votre application web pour une expérience utilisateur transparente."
---

L'intégration des outils UBIK dans votre propre application offre un moyen puissant d'étendre les capacités de votre produit. Ce guide vous guidera à travers le processus d'intégration sécurisée d'un outil à l'aide d'un `<iframe>`.

<Steps>

<Step title="Configurer les Origines Autorisées">
  Pour empêcher les domaines non autorisés d'intégrer vos outils, vous devez d'abord configurer une liste d'**Origines Autorisées** pour votre clé API. C'est une étape de sécurité essentielle. Une "origine" est la combinaison d'un protocole, d'un domaine et d'un port (par exemple, `https://votreapp.com`).

  Vous pouvez définir les origines autorisées pour vos clés API sur la page des paramètres de votre compte dans le tableau de bord UBIK.

  <Card
    title="Accéder aux paramètres de la clé API"
    icon="key"
    href="https://app.ubik-agent.com/user/security"
  />

  <Note>
  Pour le développement local, vous pouvez ajouter des origines comme `http://localhost:3000`. Pour la production, assurez-vous de n'ajouter que les domaines où votre application est hébergée.
  </Note>
</Step>

<Step title="Récupérer les Informations d'Intégration">
  Avant de pouvoir afficher l'`<iframe>`, le frontend de votre application doit récupérer les détails d'intégration depuis l'API UBIK. Pour ce faire, effectuez une requête `GET` vers l'endpoint `/tools/{tool_id}/embed-info`.

  Cet endpoint fournit deux informations cruciales :
  1.  **Détails de l'Outil**: Le schéma, le nom, la description, etc.
  2.  **Jeton d'Accès**: Un JSON Web Token (JWT) de courte durée que l'`<iframe>` intégré utilisera pour s'authentifier.

  <CodeGroup title="GET /tools/{tool_id}/embed-info">
  ```bash cURL
  curl -X GET "https://app.ubik-agent.com/api/v1/tools/VOTRE_ID_OUTIL/embed-info" \
       -H "X-API-KEY: VOTRE_CLE_API"
  ```
  ```python Python (Côté Serveur)
  import requests

  api_key = "VOTRE_CLE_API"
  tool_id = "VOTRE_ID_OUTIL"
  
  headers = {"X-API-KEY": api_key}
  
  # Cet appel serait typiquement effectué depuis votre serveur, qui transmettrait
  # ensuite les informations d'intégration à votre client frontend.
  response = requests.get(
      f"https://app.ubik-agent.com/api/v1/tools/{tool_id}/embed-info",
      headers=headers
  )

  if response.status_code == 200:
      embed_info = response.json()
      print(embed_info)
      # Transmettez ces informations à votre frontend
  else:
      print(f"Erreur: {response.status_code}", response.text)
  ```
  ```javascript JavaScript (Côté Client)
  // Cette fonction appellerait typiquement un endpoint sur VOTRE serveur,
  // qui effectuerait ensuite l'appel sécurisé à l'API UBIK avec votre clé API secrète.
  
  async function fetchEmbedInfoFromServer(toolId) {
    try {
      // Exemple : un endpoint sur votre propre backend
      const response = await fetch(`/api/get-tool-embed-info?toolId=${toolId}`);
      if (!response.ok) {
        throw new Error(`Erreur HTTP: ${response.status}`);
      }
      const embedInfo = await response.json();
      console.log(embedInfo);
      // Utilisez ces données pour afficher l'iframe
      return embedInfo;
    } catch (error) {
      console.error('Erreur lors de la récupération des infos d''intégration:', error);
    }
  }
  ```
  </CodeGroup>
  
  <Tip icon="shield-check">
    **Bonne Pratique de Sécurité**: Votre clé API secrète UBIK ne doit jamais être exposée dans votre application frontend. L'appel à `/embed-info` doit être effectué depuis votre serveur backend, qui peut ensuite transmettre le `access_token` de courte durée et les détails de l'outil au client.
  </Tip>
</Step>

<Step title="Afficher l'iframe">
  Une fois que votre frontend dispose des informations d'intégration, vous pouvez construire l'URL de l'`<iframe>` et l'afficher. Le `access_token` de l'endpoint `embed-info` doit être passé comme paramètre de requête `jwt` à l'URL source de l'`iframe`.

  Voici un exemple simplifié avec React :

  ```jsx Exemple React
  import React, { useState, useEffect } from 'react';

  const EmbeddedTool = ({ toolId }) => {
    const [embedInfo, setEmbedInfo] = useState(null);

    useEffect(() => {
      // Dans une vraie application, ceci récupérerait les données depuis votre backend
      const fetchEmbedInfo = async () => {
        try {
          const response = await fetch(`/api/get-tool-embed-info?toolId=${toolId}`);
          const data = await response.json();
          setEmbedInfo(data);
        } catch (error) {
          console.error("Échec de la récupération des informations d'intégration:", error);
        }
      };

      fetchEmbedInfo();
    }, [toolId]);

    if (!embedInfo) {
      return <div>Chargement de l'outil...</div>;
    }

    // Ajoutez le jeton d'accès en tant que paramètre de requête.
    const iframeSrc = `https://app.ubik-agent.com/embed/tools/${embedInfo.id}?jwt=${embedInfo.access_token}`;

    return (
      <iframe
        src={iframeSrc}
        title={embedInfo.name}
        width="100%"
        height="600px"
        frameBorder="0"
      />
    );
  };

  export default EmbeddedTool;
  ```

  <Note>
    **Utiliser une clé API directe :** Pour les scénarios où vous préférez ne pas utiliser l'endpoint `/embed-info` (par exemple, le rendu côté serveur), vous pouvez également vous authentifier en passant votre clé API UBIK directement en tant que paramètre de requête `apiKey`.
    
    `const iframeSrc = \`https://app.ubik-agent.com/embed/tools/VOTRE_ID_OUTIL?apiKey=VOTRE_CLE_API\`;`
    
    Cependant, pour les applications côté client, il est fortement recommandé d'utiliser le `access_token` de courte durée pour éviter d'exposer votre clé API secrète.
  </Note>
</Step>

<Step title="Personnaliser l'Outil Intégré">
  Vous pouvez personnaliser l'apparence et le comportement de l'outil intégré en ajoutant des paramètres de requête à l'URL source de l'`<iframe>`.

  Voici une liste des paramètres disponibles :

  - **`jwt`** (string) : Un JSON Web Token de courte durée obtenu depuis l'endpoint `/tools/{tool_id}/embed-info`. C'est la méthode recommandée pour l'authentification côté client.
  - **`apiKey`** (string) : Votre clé API UBIK. Elle peut être utilisée pour l'authentification à la place d'un JWT, mais elle est moins sécurisée pour les applications côté client car elle peut exposer votre clé secrète.
  - **`theme`** ('light' | 'dark') : Définit le thème de couleur par défaut pour l'interface de l'outil. S'il n'est pas fourni, il s'adapte à la préférence système de l'utilisateur.
  - **`showThemeToggle`** (boolean) : Si défini sur `true`, un sélecteur de thème sera affiché dans l'en-tête de l'outil, permettant aux utilisateurs de basculer entre le mode clair et le mode sombre.
  - **`showLangToggle`** (boolean) : Si défini sur `true`, un sélecteur de langue sera affiché, permettant aux utilisateurs de changer la langue d'affichage.

  Exemple d'URL avec personnalisation :
  ```
  https://app.ubik-agent.com/embed/tools/VOTRE_ID_OUTIL?jwt=VOTRE_JWT&theme=dark&showThemeToggle=true
  ```
</Step>

</Steps>

En suivant ces étapes, vous pouvez intégrer en toute sécurité les puissants outils d'UBIK directement dans votre application, créant une expérience transparente et intégrée pour vos utilisateurs.
