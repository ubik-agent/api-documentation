---
title: "Guide : Intégrer UBIK avec un iframe"
description: "Apprenez à intégrer en toute sécurité l'interface utilisateur d'un outil UBIK directement dans votre application web pour une expérience utilisateur transparente."
---

L'intégration des outils UBIK dans votre propre application offre un moyen puissant d'étendre les capacités de votre produit. Ce guide vous guidera à travers le processus d'intégration sécurisée d'un outil à l'aide d'un `<iframe>`.

<Steps>

<Step title="Configurer les Origines Autorisées">
  Pour empêcher les domaines non autorisés d'intégrer vos outils, vous devez d'abord configurer une liste d'**Origines Autorisées** pour votre clé API. C'est une étape de sécurité essentielle. Une "origine" est la combinaison d'un protocole, d'un domaine et d'un port (par exemple, `https://votreapp.com`).

  Vous pouvez définir les origines autorisées pour vos clés API sur la page des paramètres de votre compte dans le tableau de bord UBIK.

  <Card
    title="Accéder aux paramètres de la clé API"
    icon="key"
    href="https://app.ubik-agent.com/user/api-keys"
  />

  <Note>
  Pour le développement local, vous pouvez ajouter des origines comme `http://localhost:3000`. Pour la production, assurez-vous de n'ajouter que les domaines où votre application est hébergée.
  </Note>
</Step>

<Step title="Récupérer les Informations d'Intégration">
  Avant de pouvoir afficher l'`<iframe>`, le frontend de votre application doit récupérer les détails d'intégration depuis l'API UBIK. Pour ce faire, effectuez une requête `GET` vers le point de terminaison `/tools/{tool_id}/embed-info`.

  Ce point de terminaison fournit deux informations cruciales :
  1.  **Détails de l'Outil**: Le schéma, le nom, la description, etc.
  2.  **Jeton d'Accès**: Un JSON Web Token (JWT) de courte durée que l'`<iframe>` intégré utilisera pour s'authentifier.

  <CodeGroup title="GET /tools/{tool_id}/embed-info">
  ```bash cURL
  curl -X GET "https://app.ubik-agent.com/api/v1/tools/VOTRE_ID_OUTIL/embed-info" \
       -H "X-API-KEY: VOTRE_CLE_API"
  ```
  ```python Python (Côté Serveur)
  import requests

  api_key = "VOTRE_CLE_API"
  tool_id = "VOTRE_ID_OUTIL"
  
  headers = {"X-API-KEY": api_key}
  
  # Cet appel serait typiquement effectué depuis votre serveur, qui transmettrait
  # ensuite les informations d'intégration à votre client frontend.
  response = requests.get(
      f"https://app.ubik-agent.com/api/v1/tools/{tool_id}/embed-info",
      headers=headers
  )

  if response.status_code == 200:
      embed_info = response.json()
      print(embed_info)
      # Transmettez ces informations à votre frontend
  else:
      print(f"Erreur: {response.status_code}", response.text)
  ```
  ```javascript JavaScript (Côté Client)
  // Cette fonction appellerait typiquement un point de terminaison sur VOTRE serveur,
  // qui effectuerait ensuite l'appel sécurisé à l'API UBIK avec votre clé API secrète.
  
  async function fetchEmbedInfoFromServer(toolId) {
    try {
      // Exemple : un point de terminaison sur votre propre backend
      const response = await fetch(`/api/get-tool-embed-info?toolId=${toolId}`);
      if (!response.ok) {
        throw new Error(`Erreur HTTP: ${response.status}`);
      }
      const embedInfo = await response.json();
      console.log(embedInfo);
      // Utilisez ces données pour afficher l'iframe
      return embedInfo;
    } catch (error) {
      console.error('Erreur lors de la récupération des infos d''intégration:', error);
    }
  }
  ```
  </CodeGroup>
  
  <Tip icon="shield-check">
    **Bonne Pratique de Sécurité**: Votre clé API secrète UBIK ne doit jamais être exposée dans votre application frontend. L'appel à `/embed-info` doit être effectué depuis votre serveur backend, qui peut ensuite transmettre le `access_token` de courte durée et les détails de l'outil au client.
  </Tip>
</Step>

<Step title="Afficher l'iframe">
  Une fois que votre frontend dispose des informations d'intégration, vous pouvez construire l'URL de l'`<iframe>` et l'afficher. L'URL doit être au format : `/embed/tools/{tool_id}`.

  Vous devrez ensuite envoyer l'`access_token` à l'`<iframe>` en utilisant `postMessage` une fois qu'elle est chargée.

  Voici un exemple simplifié avec React :

  ```jsx Exemple React
  import React, { useState, useEffect, useRef } from 'react';

  const EmbeddedTool = ({ toolId }) => {
    const [embedInfo, setEmbedInfo] = useState(null);
    const iframeRef = useRef(null);

    useEffect(() => {
      // Dans une vraie application, ceci récupérerait les données depuis votre backend
      const fetchEmbedInfo = async () => {
        const response = await fetch(`/api/get-tool-embed-info?toolId=${toolId}`);
        const data = await response.json();
        setEmbedInfo(data);
      };

      fetchEmbedInfo();
    }, [toolId]);

    const handleIframeLoad = () => {
      if (iframeRef.current && embedInfo?.access_token) {
        // L'origine cible doit être celle de l'application UBIK
        const targetOrigin = "https://app.ubik-agent.com";
        iframeRef.current.contentWindow.postMessage(
          {
            type: 'UBIK_EMBED_TOKEN',
            token: embedInfo.access_token,
          },
          targetOrigin
        );
      }
    };

    if (!embedInfo) {
      return <div>Chargement de l'outil...</div>;
    }

    const iframeSrc = `https://app.ubik-agent.com/embed/tools/${embedInfo.id}`;

    return (
      <iframe
        ref={iframeRef}
        src={iframeSrc}
        onLoad={handleIframeLoad}
        title={embedInfo.name}
        width="100%"
        height="600px"
        frameBorder="0"
      />
    );
  };

  export default EmbeddedTool;
  ```

</Step>

</Steps>

En suivant ces étapes, vous pouvez intégrer en toute sécurité les puissants outils d'UBIK directement dans votre application, créant une expérience transparente et intégrée pour vos utilisateurs.
