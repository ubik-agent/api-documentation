---
title: "Guide: Getting Real-Time Results with SSE"
description: "Learn how to stream events in real-time from tool executions and agent sessions using Server-Sent Events (SSE)."
---

Polling for results is effective, but for a more responsive, real-time experience, you can stream events directly from UBIK. This guide covers the two main types of streaming available in the API:

1.  **Tool Execution Streaming**: For monitoring long-running tool tasks.
2.  **Agent Session Streaming**: For receiving real-time chat responses from agents.

## Tool Execution Streaming

This section shows you how to connect to a tool's event stream. This assumes you have already started a tool execution as shown in the [Executing Your First Tool](/en/guides/executing-tools) guide.

<Steps>

<Step title="Start a Tool Execution">
  First, execute a tool as you normally would. The initial `202 Accepted` response will contain a `stream_url`. This is the endpoint we'll use to receive live events.

  ```json Response
  {
    "execution_id": "exec_123456789",
    "status": "pending",
    "tool_id": "d1e2f3a4-b5c6-7890-1234-567890abcdef",
    "details_url": "https://app.ubik-agent.com/api/v1/tool-executions/exec_123456789",
    "stream_url": "https://app.ubik-agent.com/api/v1/tool-executions/exec_123456789/stream"
  }
  ```
  
  Copy the `stream_url` for the next step.
</Step>

<Step title="Connect to the Event Stream">
  Now, you can connect to the `stream_url` using any SSE-compatible client. The connection will remain open, and the server will push events as they happen.

  <CodeGroup title="GET /tool-executions/{execution_id}/stream">
  ```bash cURL
  # Use the -N flag to disable buffering
  curl -X GET "https://app.ubik-agent.com/api/v1/tool-executions/exec_123456789/stream" \
       -H "X-API-KEY: YOUR_API_KEY" \
       -N
  ```
  ```python Python
  import requests
  import json

  api_key = "YOUR_API_KEY"
  stream_url = "https://app.ubik-agent.com/api/v1/tool-executions/exec_123456789/stream"
  
  headers = {"X-API-KEY": api_key, "Accept": "text/event-stream"}

  with requests.get(stream_url, headers=headers, stream=True) as response:
      if response.status_code == 200:
          for line in response.iter_lines():
              if line:
                  decoded_line = line.decode('utf-8')
                  if decoded_line.startswith('data:'):
                      try:
                          # Extract the JSON part of the message
                          json_data = decoded_line[5:].strip()
                          event_payload = json.loads(json_data)
                          print("Received event:", event_payload)
                          
                          # Check for the end of the stream
                          if event_payload.get("event_type") == "final_result":
                              print("Stream finished.")
                              break
                      except json.JSONDecodeError:
                          print(f"Could not decode line: {decoded_line}")
      else:
          print(f"Error connecting to stream: {response.status_code}", response.text)
  ```
  ```javascript JavaScript
  const apiKey = "YOUR_API_KEY";
  const streamUrl = "https://app.ubik-agent.com/api/v1/tool-executions/exec_123456789/stream";

  const eventSource = new EventSource(`${streamUrl}?api_key=${apiKey}`);

  eventSource.onopen = () => {
    console.log("Connection to event stream opened.");
  };

  eventSource.onmessage = (event) => {
    const eventPayload = JSON.parse(event.data);
    console.log("Received event:", eventPayload);

    if (eventPayload.event_type === "final_result") {
      console.log("Stream finished. Closing connection.");
      eventSource.close();
    }
  };

  eventSource.onerror = (error) => {
    console.error("EventSource failed:", error);
    eventSource.close();
  };
  ```
  </CodeGroup>
  
  <Note>
  In the JavaScript `EventSource` example, we pass the API key as a query parameter. Our server is configured to accept the API key from either the `X-API-KEY` header or a query parameter named `api_key` for SSE connections, as `EventSource` does not support custom headers.
  </Note>

</Step>

<Step title="Tool Execution Events">
  As the tool executes, you will receive a series of JSON objects. Each object contains an `event_type` and a `data` payload. Here are the main event types:

  - **`tool_update`**: A general progress update. The `data` payload often contains `phase` and `message` fields to describe the current state.
  - **`tool_partial_update`**: A chunk of streaming content. The `data` payload contains a `content` field with the text.
  - **`final_result`**: The final event of a successful execution, containing the complete `outputs` in the `data` payload.
  - **`tool_input_required`**: Sent when an interactive tool needs user input.
  - **`error`**: Indicates that an error occurred during execution.

  ```json Example Event Stream
  data: {"event_type": "tool_update", "data": {"phase": "retrieval", "message": "Fetching relevant documents..."}}

  data: {"event_type": "tool_update", "data": {"phase": "generation", "message": "Generating response..."}}

  data: {"event_type": "tool_partial_update", "data": {"content": "The financial results show..."}}

  data: {"event_type": "tool_partial_update", "data": {"content": " a significant increase in revenue."}}

  data: {"event_type": "final_result", "data": {"outputs": {"response": "The financial results show a significant increase in revenue."}}}
  ```
</Step>

</Steps>

## Agent Session Streaming

Agent Sessions provide a different set of events tailored for conversational interfaces. When you send a message with `"stream": true`, the server will stream the agent's thought process and response chunks.

### Agent Session Events

Unlike tool executions, agent session events are often used to render a chat interface in real-time.

For a complete list of event types and their structure, please refer to the [Agent Session Events Guide](/en/guides/agent-session-events).

### Dedicated Stream Endpoint

While `POST /agent-sessions/{id}/messages` supports direct streaming, UBIK also provides a dedicated endpoint for subscribing to session events. This is useful for:
1.  **Reconnection**: Resuming a stream if the connection drops (past events are replayed).
2.  **Browser Compatibility**: Using `EventSource` which requires a GET request and URL-based auth.

**Endpoint**: `GET /agent-sessions/{session_id}/stream`

#### Authentication with JWT

Since the standard `EventSource` API in browsers cannot send custom headers (like `X-API-KEY`), this endpoint accepts a `token` query parameter. You should generate a short-lived JWT using `/auth/token` and pass it here.

For details on generating tokens, see the [Authentication & Security Guide](/en/guides/authentication).

```javascript
// 1. Get a short-lived token from your backend
const token = "eyJhbGciOiJIUz..."; 

// 2. Connect using the token param
const streamUrl = `https://app.ubik-agent.com/api/v1/agent-sessions/${sessionId}/stream?token=${token}`;
const eventSource = new EventSource(streamUrl);
```
